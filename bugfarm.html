<!doctype html>
<html lang="en"><head>
    <!-- Bootstrap-required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!--        
    <title>id:xtable</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"  crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js" integrity="sha256-bQmrZe4yPnQrLTY+1gYylfNMBuGfnT/HKsCGX+9Xuqo=" crossorigin="anonymous"></script>

    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jplayer/2.9.2/jplayer/jquery.jplayer.min.js'></script>
    <script type='text/javascript' src='/static/js/sound.js'></script>
    <link rel="stylesheet" media="screen" type="text/css" href="/static/js/colorpicker/css/colorpicker.css" />
    <script type="text/javascript" src="/static/js/colorpicker/js/colorpicker.js"></script>
-->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"  crossorigin="anonymous"></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.js'></script>
</head><body>

<!-- CSS styling -->
<style type='text/css'>
:root {
    --main-bg-color: lightgrey;
    --main-fg-color: white;
}
body, a {
    font-family: Sans-Serif;
    color: white !important;
    background-color: var(--main-bg-color);
}
</style>

<div id='app'>
    <div id='header'></div>
    <div id='content'>
        <div id='canvas'></div>
    </div>
    <div id='footer'></div>
</div>

<script type='text/javascript'>

const paper_width = 1024;
const paper_height = 1024;
const num_bugs = 100;
const max_v = 5;

var paper;
var bugs = [];

$(document).ready(function() {
    console.log('Bug Farm here!');
    paper = Raphael(0, 0, paper_width, paper_height);

    for (var i=0; i < num_bugs; i++) bugs.push(new Bug({id: 'bug'+i}));

    window.setInterval(tick, 50);
});

function tick() {
    for (var b=0; b < num_bugs; b++) {
        bugs[b].tick();
    }
}


function Bug(options) {

    this.init = function(options) {
        console.log('init bug:', options);
        this.r = 8;
        this.infected = 0;
        this.contact_list = [];
        this.color = 'blue';
        this.fill = 'white';
        if (Math.random() > 0.5) {
            this.color = 'crimson';
            this.fill = 'darkgrey';
        }
        this.home_x = this.x = Math.random() * paper_width;
        this.home_y = this.y = Math.random() * paper_height;
        this.moving = 100;
        this.dx = Math.random() * 2 * max_v - max_v;
        this.dy = Math.random() * 2 * max_v - max_v;
        for (var o in options) this[o] = options[o];
        this.elts = [];
        this.render();
        return this;
    };

    this.tick = function() {
        this.move();
        this.infect();
    };

    this.render = function() {
        var circle = paper.circle(this.x, this.y, this.r);
        circle.attr({
            stroke: this.color,
            'stroke-opacity': 1.0,
            'stroke-width': 3,
            fill: this.fill,
            'fill-opacity': 0.5
        });
        this.elts.push(circle);
    };

    this.move = function() {
        if (this.moving <= 0) return;
        this.moving--;

        this.x += this.dx;
        while (this.x > paper_width) this.x -= paper_width;
        while (this.x < 0) this.x += paper_width;
        this.y += this.dy;
        while (this.y > paper_height) this.y -= paper_height;
        while (this.y < 0) this.y += paper_height;
        for (var e in this.elts) {
            this.elts[e].attr({'cx': this.x, 'cy': this.y});
        }
    };

    this.infect = function() {
    };

    return this.init(options || {});
}

</script>
</body>
</html>